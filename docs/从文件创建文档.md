# 从文件创建文档

> 通过上传文件在现有知识库中创建新文档。

## OpenAPI

````yaml zh-hans/openapi_knowledge.json post /datasets/{dataset_id}/document/create-by-file
paths:
  path: /datasets/{dataset_id}/document/create-by-file
  method: post
  servers:
    - url: '{apiBaseUrl}'
      description: 知识库 API 的基础 URL。
      variables:
        apiBaseUrl:
          type: string
          description: API 的实际基础 URL
          default: https://api.dify.ai/v1
  request:
    security:
      - title: ApiKeyAuth
        parameters:
          query: {}
          header:
            Authorization:
              type: http
              scheme: bearer
              description: >-
                API-Key 鉴权。所有 API 请求都应在 `Authorization` HTTP Header 中包含您的
                API-Key，格式为 `Bearer {API_KEY}`。**强烈建议开发者把 API-Key
                放在后端存储，而非分享或者放在客户端存储，以免 API-Key 泄露，导致财产损失。**
          cookie: {}
    parameters:
      path:
        dataset_id:
          schema:
            - type: string
              required: true
              description: 要添加文档的知识库 ID。
              format: uuid
      query: {}
      header: {}
      cookie: {}
    body:
      multipart/form-data:
        schemaArray:
          - type: object
            properties:
              data:
                allOf:
                  - type: string
                    description: >-
                      包含文档元数据和处理规则的 JSON 字符串。详情请参见
                      `CreateDocumentByFileRequestData` 模式。
                    example: >-
                      {"indexing_technique":"high_quality","process_rule":{"mode":"custom",
                      "rules": { "segmentation":{"separator":"###",
                      "max_tokens":500}}}}
              file:
                allOf:
                  - type: string
                    format: binary
                    description: 要上传的文件。
            required: true
        examples:
          example:
            value:
              data: >-
                {"indexing_technique":"high_quality","process_rule":{"mode":"custom",
                "rules": { "segmentation":{"separator":"###",
                "max_tokens":500}}}}
  response:
    '200':
      application/json:
        schemaArray:
          - type: object
            properties:
              document:
                allOf:
                  - $ref: '#/components/schemas/Document'
              batch:
                allOf:
                  - type: string
                    description: 用于跟踪索引进度的批次标识符。
            refIdentifier: '#/components/schemas/DocumentCreationResponse'
        examples:
          example:
            value:
              document:
                id: 3c90c3cc-0d44-4b50-8888-8dd25736052a
                position: 123
                data_source_type: <string>
                data_source_info: {}
                dataset_process_rule_id: 3c90c3cc-0d44-4b50-8888-8dd25736052a
                name: <string>
                created_from: <string>
                created_by: 3c90c3cc-0d44-4b50-8888-8dd25736052a
                created_at: 123
                tokens: 123
                indexing_status: <string>
                error: <string>
                enabled: true
                disabled_at: 123
                disabled_by: 3c90c3cc-0d44-4b50-8888-8dd25736052a
                archived: true
                display_status: <string>
                word_count: 123
                hit_count: 123
                doc_form: <string>
              batch: <string>
        description: 文档创建成功，正在被索引。
    '400':
      application/json:
        schemaArray:
          - type: object
            properties:
              code:
                allOf:
                  - &ref_0
                    type: string
                    description: 机器可读的错误代码。
              message:
                allOf:
                  - &ref_1
                    type: string
                    description: 人类可读的错误消息。
              status:
                allOf:
                  - &ref_2
                    type: integer
                    description: HTTP 状态码。
            refIdentifier: '#/components/schemas/ErrorResponse'
            example: &ref_3
              code: no_file_uploaded
              message: 请上传您的文件。
              status: 400
        examples:
          example:
            value:
              code: no_file_uploaded
              message: 请上传您的文件。
              status: 400
        description: 与文件上传相关的错误请求。可能是 `no_file_uploaded` 或 `too_many_files`。
    '413':
      application/json:
        schemaArray:
          - type: object
            properties:
              code:
                allOf:
                  - *ref_0
              message:
                allOf:
                  - *ref_1
              status:
                allOf:
                  - *ref_2
            refIdentifier: '#/components/schemas/ErrorResponse'
            example: *ref_3
        examples:
          example:
            value:
              code: no_file_uploaded
              message: 请上传您的文件。
              status: 400
        description: 文件大小超出限制。
    '415':
      application/json:
        schemaArray:
          - type: object
            properties:
              code:
                allOf:
                  - *ref_0
              message:
                allOf:
                  - *ref_1
              status:
                allOf:
                  - *ref_2
            refIdentifier: '#/components/schemas/ErrorResponse'
            example: *ref_3
        examples:
          example:
            value:
              code: no_file_uploaded
              message: 请上传您的文件。
              status: 400
        description: 不允许的文件类型。
  deprecated: false
  type: path
components:
  schemas:
    Document:
      type: object
      properties:
        id:
          type: string
          format: uuid
        position:
          type: integer
        data_source_type:
          type: string
        data_source_info:
          type: object
          nullable: true
        dataset_process_rule_id:
          type: string
          format: uuid
          nullable: true
        name:
          type: string
        created_from:
          type: string
        created_by:
          type: string
          format: uuid
        created_at:
          type: integer
          format: int64
        tokens:
          type: integer
        indexing_status:
          type: string
        error:
          type: string
          nullable: true
        enabled:
          type: boolean
        disabled_at:
          type: integer
          format: int64
          nullable: true
        disabled_by:
          type: string
          format: uuid
          nullable: true
        archived:
          type: boolean
        display_status:
          type: string
        word_count:
          type: integer
        hit_count:
          type: integer
        doc_form:
          type: string

````